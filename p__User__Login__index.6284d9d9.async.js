(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{96676:function(se,A,e){"use strict";e.r(A),e.d(A,{default:function(){return Y}});var O=e(15009),l=e.n(O),Z=e(97857),p=e.n(Z),U=e(99289),x=e.n(U),N=e(5574),M=e.n(N),$=e(99702),o=e(35312);function R(f,r){return S.apply(this,arguments)}function S(){return S=x()(l()().mark(function f(r,i){return l()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,o.request)("/api/v1/admin/index/login",p()({method:"POST",headers:{"Content-Type":"application/json"},data:r},i||{})));case 1:case"end":return m.stop()}},f)})),S.apply(this,arguments)}var w=e(87547),z=e(94149),H=e(68262),L=e(5966),V=e(63434),W=e(19922),D=e(99138),F=e(2453),E=e(93980),G=e(67610),C=e(67294),b=e(73935),K=e(55835),Q=e(46176),a=e(85893),re=function(){var r=useEmotionCss(function(i){var c=i.token;return{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:c.colorPrimaryActive}}});return _jsxs(_Fragment,{children:[_jsx(AlipayCircleOutlined,{className:r},"AlipayCircleOutlined"),_jsx(TaobaoCircleOutlined,{className:r},"TaobaoCircleOutlined"),_jsx(WeiboCircleOutlined,{className:r},"WeiboCircleOutlined")]})},ie=function(){var r=useEmotionCss(function(i){var c=i.token;return{width:42,height:42,lineHeight:"42px",position:"fixed",right:16,borderRadius:c.borderRadius,":hover":{backgroundColor:c.colorBgTextHover}}});return _jsx("div",{className:r,"data-lang":!0,children:SelectLang&&_jsx(SelectLang,{})})},J=function(r){var i=r.content;return(0,a.jsx)(D.Z,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},X=function(){var r=(0,C.useState)({code:0}),i=M()(r,2),c=i[0],m=i[1],k=(0,C.useState)("account"),I=M()(k,2),T=I[0],q=I[1],B=(0,o.useModel)("@@initialState"),j=B.initialState,_=B.setInitialState,ee=(0,W.l)(function(){return{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}),g=(0,o.useIntl)(),ae=function(){var v=x()(l()().mark(function u(){var d,n;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,j==null||(d=j.fetchUserInfo)===null||d===void 0?void 0:d.call(j);case 2:n=s.sent,console.log("userinfo ## ",n),n&&(0,b.flushSync)(function(){_(function(y){return p()(p()({},y),{},{currentUser:n})})});case 5:case"end":return s.stop()}},u)}));return function(){return v.apply(this,arguments)}}(),ne=function(){var v=x()(l()().mark(function u(d){var n,h,s,y,P;return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R(p()({},d));case 3:if(n=t.sent,n.code!==0){t.next=13;break}return s=g.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),F.ZP.success(s),localStorage.setItem(Q.B,(h=n.data)===null||h===void 0?void 0:h.token),t.next=10,ae();case 10:return y=new URL(window.location.href).searchParams,o.history.push(y.get("redirect")||"/"),t.abrupt("return");case 13:console.log(n),m(n),t.next=22;break;case 17:t.prev=17,t.t0=t.catch(0),P=g.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(t.t0),F.ZP.error(P);case 22:case"end":return t.stop()}},u,null,[[0,17]])}));return function(d){return v.apply(this,arguments)}}(),te=c.code;return(0,a.jsxs)("div",{className:ee,children:[(0,a.jsx)(o.Helmet,{children:(0,a.jsxs)("title",{children:[g.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",G.Z.title]})}),(0,a.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,a.jsxs)(H.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,a.jsx)("img",{alt:"logo",src:"/logo.png",style:{verticalAlign:"middle"}}),title:"\u58F0\u6240Admin",initialValues:{autoLogin:!0},actions:[],onFinish:function(){var v=x()(l()().mark(function u(d){var n;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return n=d,n.password=K.createHash("sha1").update(n.password).digest("hex"),s.next=4,ne(n);case 4:case"end":return s.stop()}},u)}));return function(u){return v.apply(this,arguments)}}(),children:[(0,a.jsx)(E.Z,{activeKey:T,onChange:q,centered:!0,items:[{key:"account",label:g.formatMessage({id:"pages.login.accountLogin.tab",defaultMessage:"\u8D26\u6237\u5BC6\u7801\u767B\u5F55"})}]}),te!==0&&(0,a.jsx)(J,{content:g.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),T==="account"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(L.Z,{name:"account",fieldProps:{size:"large",prefix:(0,a.jsx)(w.Z,{})},placeholder:g.formatMessage({id:"pages.login.username.placeholder",defaultMessage:"\u7528\u6237\u540D: admin or user"}),rules:[{required:!0,message:(0,a.jsx)(o.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,a.jsx)(L.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,a.jsx)(z.Z,{})},placeholder:g.formatMessage({id:"pages.login.password.placeholder",defaultMessage:"\u5BC6\u7801: ant.design"}),rules:[{required:!0,message:(0,a.jsx)(o.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]}),(0,a.jsxs)("div",{style:{marginBottom:24},children:[(0,a.jsx)(V.Z,{noStyle:!0,name:"autoLogin",children:(0,a.jsx)(o.FormattedMessage,{id:"pages.login.rememberMe",defaultMessage:"\u81EA\u52A8\u767B\u5F55"})}),(0,a.jsx)("a",{style:{float:"right"},children:(0,a.jsx)(o.FormattedMessage,{id:"pages.login.forgotPassword",defaultMessage:"\u5FD8\u8BB0\u5BC6\u7801"})})]})]})}),(0,a.jsx)($.Z,{})]})},Y=X},80950:function(){},46601:function(){},89214:function(){},8623:function(){},7748:function(){},85568:function(){},56619:function(){},77108:function(){},52361:function(){},94616:function(){},69862:function(){},40964:function(){}}]);
