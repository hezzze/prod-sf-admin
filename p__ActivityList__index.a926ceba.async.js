"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[264],{5966:function(fe,I,a){var L=a(1413),F=a(91),V=a(85893),U=a(54425),N=["fieldProps","proFieldProps"],u=["fieldProps","proFieldProps"],O="text",y=function(A){var M=A.fieldProps,W=A.proFieldProps,C=(0,F.Z)(A,N);return(0,V.jsx)(U.Z,(0,L.Z)({valueType:O,fieldProps:M,filedConfig:{valueType:O},proFieldProps:W},C))},G=function(A){var M=A.fieldProps,W=A.proFieldProps,C=(0,F.Z)(A,u);return(0,V.jsx)(U.Z,(0,L.Z)({valueType:"password",fieldProps:M,proFieldProps:W,filedConfig:{valueType:O}},C))},j=y;j.Password=G,j.displayName="ProFormComponent",I.Z=j},96809:function(fe,I,a){a.r(I),a.d(I,{default:function(){return Ue}});var L=a(97857),F=a.n(L),V=a(13769),U=a.n(V),N=a(15009),u=a.n(N),O=a(99289),y=a.n(O),G=a(5574),j=a.n(G),o=a(35312);function A(p,t,l){return M.apply(this,arguments)}function M(){return M=y()(u()().mark(function p(t,l,h){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,o.request)("/api/v1/admin/activity/create",F()({method:"POST",headers:{"Content-Type":"application/json"},params:F()({},t),data:l},h||{})));case 1:case"end":return n.stop()}},p)})),M.apply(this,arguments)}function W(p,t,l){return C.apply(this,arguments)}function C(){return C=_asyncToGenerator(_regeneratorRuntime().mark(function p(t,l,h){return _regeneratorRuntime().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",request("/api/v1/admin/activity/detail",_objectSpread({method:"POST",headers:{"Content-Type":"application/json"},params:_objectSpread({},t),data:l},h||{})));case 1:case"end":return n.stop()}},p)})),C.apply(this,arguments)}function he(p,t,l){return Y.apply(this,arguments)}function Y(){return Y=y()(u()().mark(function p(t,l,h){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,o.request)("/api/v1/admin/activity/list",F()({method:"POST",headers:{"Content-Type":"application/json"},params:F()({},t),data:l},h||{})));case 1:case"end":return n.stop()}},p)})),Y.apply(this,arguments)}function ge(p,t,l){return H.apply(this,arguments)}function H(){return H=y()(u()().mark(function p(t,l,h){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,o.request)("/api/v1/admin/activity/modify",F()({method:"POST",headers:{"Content-Type":"application/json"},params:F()({},t),data:l},h||{})));case 1:case"end":return n.stop()}},p)})),H.apply(this,arguments)}function ye(p,t,l){return J.apply(this,arguments)}function J(){return J=y()(u()().mark(function p(t,l,h){return u()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",(0,o.request)("/api/v1/admin/activity/remove",F()({method:"POST",headers:{"Content-Type":"application/json"},params:F()({},t),data:l},h||{})));case 1:case"end":return n.stop()}},p)})),J.apply(this,arguments)}var Pe=a(51042),R=a(1413),Q=a(91),e=a(85893),T=a(67294),Fe=a(66758),X=a(54425),xe=["fieldProps","proFieldProps"],re="dateTime",Te=T.forwardRef(function(p,t){var l=p.fieldProps,h=p.proFieldProps,g=(0,Q.Z)(p,xe),n=(0,T.useContext)(Fe.Z);return(0,e.jsx)(X.Z,(0,R.Z)({ref:t,fieldProps:(0,R.Z)({getPopupContainer:n.getPopupContainer},l),valueType:re,proFieldProps:h,filedConfig:{valueType:re,customLightMode:!0}},g))}),z=Te,je=["fieldProps","min","proFieldProps","max"],Ae=function(t,l){var h=t.fieldProps,g=t.min,n=t.proFieldProps,B=t.max,q=(0,Q.Z)(t,je);return(0,e.jsx)(X.Z,(0,R.Z)({valueType:"digit",fieldProps:(0,R.Z)({min:g,max:B},h),ref:l,filedConfig:{defaultProps:{width:"100%"}},proFieldProps:n},q))},se=T.forwardRef(Ae),Se=a(18814),Me=a(68405),Ce=a(2236),be=a(37476),K=a(5966),we=["fieldProps","proFieldProps"],Ze=function(t,l){var h=t.fieldProps,g=t.proFieldProps,n=(0,Q.Z)(t,we);return(0,e.jsx)(X.Z,(0,R.Z)({ref:l,valueType:"textarea",fieldProps:h,proFieldProps:g},n))},ne=T.forwardRef(Ze),De=a(2048),S=a(2453),Oe=a(96365),ie=a(71577),Re=a(85265),k=a(62113),Be=a(69400),$e=a(27484),b=a.n($e),Ee=function(t){var l=(0,o.useIntl)();return(0,e.jsxs)(k.L,{stepsProps:{size:"small"},stepsFormRender:function(g,n){return(0,e.jsx)(Be.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u7F16\u8F91\u6D3B\u52A8",open:t.updateModalOpen,footer:n,onCancel:function(){t.onCancel()},children:g})},onFinish:t.onSubmit,children:[(0,e.jsxs)(k.L.StepForm,{initialValues:{activity_name:t.values.activity_name,introduction:t.values.introduction,location:t.values.location},title:l.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),children:[(0,e.jsx)(K.Z,{name:"activity_name",label:"\u6D3B\u52A8\u540D\u79F0",width:"md",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0\uFF01"}]}),(0,e.jsx)(ne,{name:"introduction",width:"md",label:"\u6D3B\u52A8\u63CF\u8FF0",placeholder:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01",min:5}]}),(0,e.jsx)(K.Z,{name:"location",label:"\u6D3B\u52A8\u5730\u5740",width:"md",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u5730\u5740\uFF01"}]})]}),(0,e.jsxs)(k.L.StepForm,{initialValues:{start_at:b()(t.values.start_at),end_at:b()(t.values.end_at),max_apply:t.values.max_apply},title:l.formatMessage({id:"pages.searchTable.activity.scheduleTitle",defaultMessage:"\u6D3B\u52A8\u65F6\u95F4"}),children:[(0,e.jsx)(z,{name:"start_at",width:"md",label:"\u5F00\u59CB\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5F00\u59CB\u65F6\u95F4\uFF01"}]}),(0,e.jsx)(z,{name:"end_at",width:"md",label:"\u7ED3\u675F\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7ED3\u675F\u65F6\u95F4\uFF01"}]}),(0,e.jsx)(se,{name:"max_apply",width:"md",min:1,label:"\u6700\u5927\u62A5\u540D\u4EBA\u6570",fieldProps:{precision:0},rules:[{required:!0,message:"\u6700\u5927\u62A5\u540D\u4EBA\u6570!"}]})]})]})},Ie=Ee,Le=["defaultRender"],Ve=function(){var t=(0,T.useState)(!1),l=j()(t,2),h=l[0],g=l[1],n=(0,T.useState)(!1),B=j()(n,2),q=B[0],_=B[1],We=(0,T.useState)(!1),ue=j()(We,2),le=ue[0],de=ue[1],w=(0,T.useRef)(),ze=(0,T.useState)(),oe=j()(ze,2),P=oe[0],$=oe[1],Ke=(0,T.useState)([]),ce=j()(Ke,2),E=ce[0],pe=ce[1],Ne=(0,o.useModel)("@@initialState"),x=Ne.initialState,Ge=function(){var c=y()(u()().mark(function i(r){var d,v,s;return u()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return d=S.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),f.prev=1,f.next=4,A({},{data:Object.assign(r,{type:1,activity_name:"\u6D4B\u8BD5\u6D3B\u52A8",themes:[],requirement:"",location_point:{lat:"30.501272",lng:"104.078927"},start_at:b()(r.start_at).unix(),end_at:b()(r.end_at).unix(),status:1,cover:"https://example.com/1.png"})},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x==null||(v=x.currentUser)===null||v===void 0?void 0:v.token)}});case 4:if(s=f.sent,d(),s.code!==0){f.next=9;break}return S.ZP.success("Added successfully"),f.abrupt("return",!0);case 9:throw"failed";case 12:return f.prev=12,f.t0=f.catch(1),d(),S.ZP.error("Adding failed, please try again!"),f.abrupt("return",!1);case 17:case"end":return f.stop()}},i,null,[[1,12]])}));return function(r){return c.apply(this,arguments)}}(),Ye=function(){var c=y()(u()().mark(function i(r){var d;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(d=S.ZP.loading("\u6B63\u5728\u5220\u9664"),r){s.next=3;break}return s.abrupt("return",!0);case 3:return s.prev=3,s.next=6,Promise.all(r.map(function(m){var f;return ye({},{search:{activity_id:m.activity_id}},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x==null||(f=x.currentUser)===null||f===void 0?void 0:f.token)}})}));case 6:return s.next=8,d();case 8:return S.ZP.success("Deleted successfully and will refresh soon"),s.abrupt("return",!0);case 12:return s.prev=12,s.t0=s.catch(3),d(),S.ZP.error("Delete failed, please try again"),s.abrupt("return",!1);case 17:case"end":return s.stop()}},i,null,[[3,12]])}));return function(r){return c.apply(this,arguments)}}(),He=function(){var c=y()(u()().mark(function i(r){var d,v;return u()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return d=S.ZP.loading("Configuring"),console.log(r),m.prev=2,m.next=5,ge({},{data:Object.assign(r,{type:1,activity_name:"\u6D4B\u8BD5\u6D3B\u52A8",themes:[],requirement:"",location_point:{lat:"30.501272",lng:"104.078927"},start_at:b()(r.start_at).unix(),end_at:b()(r.end_at).unix(),status:1,cover:"https://example.com/1.png"}),search:{activity_id:P==null?void 0:P.activity_id}},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x==null||(v=x.currentUser)===null||v===void 0?void 0:v.token)}});case 5:return d(),S.ZP.success("Configuration is successful"),m.abrupt("return",!0);case 10:return m.prev=10,m.t0=m.catch(2),d(),S.ZP.error("Configuration failed, please try again!"),m.abrupt("return",!1);case 15:case"end":return m.stop()}},i,null,[[2,10]])}));return function(r){return c.apply(this,arguments)}}();function Je(c,i){return ee.apply(this,arguments)}function ee(){return ee=y()(u()().mark(function c(i,r){var d,v,s,m,f;return u()().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,he({},{page:{page:i.current,page_size:i.pageSize},sort:{create_at:r.created_at==="ascend"?"asc":"desc"},search:{type:1}},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(x==null||(d=x.currentUser)===null||d===void 0?void 0:d.token)}});case 2:return f=Z.sent,Z.abrupt("return",{data:(v=f.data)===null||v===void 0||(s=v.list)===null||s===void 0?void 0:s.map(function(D){var ae,te;return Object.assign(D,{statusValue:(ae=D.status)===null||ae===void 0?void 0:ae.value,typeValue:(te=D.type)===null||te===void 0?void 0:te.value,create_at:+"".concat(D.create_at,"000"),start_at:+"".concat(D.start_at,"000"),end_at:+"".concat(D.end_at,"000")})}),success:!0,total:(m=f.data)===null||m===void 0?void 0:m.total});case 4:case"end":return Z.stop()}},c)})),ee.apply(this,arguments)}var ve=(0,o.useIntl)(),me=[{title:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.updateForm.activity.idLabel",defaultMessage:"Activity Id"}),dataIndex:"activity_id",tip:"The rule name is the unique key",render:function(i,r){return(0,e.jsx)("a",{onClick:function(){$(r),de(!0)},children:i})}},{title:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.activity.nameLabel",defaultMessage:"Activity Name"}),dataIndex:"activity_name",valueType:"text"},{title:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.activity.desc",defaultMessage:"Description"}),dataIndex:"introduction",valueType:"textarea"},{title:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.titleStatus",defaultMessage:"Status"}),dataIndex:"statusValue",hideInForm:!0,valueEnum:{2:{text:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.nameStatus.default",defaultMessage:"Shut down"}),status:"Default"},0:{text:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.activity.status.draft",defaultMessage:"Not published"}),status:"Processing"},1:{text:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.activity.status.published",defaultMessage:"Published"}),status:"Success"},3:{text:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.nameStatus.abnormal",defaultMessage:"Abnormal"}),status:"Error"}}},{title:"\u5F00\u59CB\u65F6\u95F4",sorter:!0,dataIndex:"start_at",valueType:"dateTime"},{title:"\u7ED3\u675F\u65F6\u95F4",sorter:!0,dataIndex:"end_at",valueType:"dateTime"},{title:"\u6700\u5927\u62A5\u540D\u4EBA\u6570",dataIndex:"max_apply",valueType:"digit"},{title:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.activity.createDate",defaultMessage:"created time"}),sorter:!0,dataIndex:"create_at",valueType:"dateTime",renderFormItem:function(i,r,d){var v=r.defaultRender,s=U()(r,Le),m=d.getFieldValue("status");return"".concat(m)==="0"?!1:"".concat(m)==="3"?(0,e.jsx)(Oe.Z,F()(F()({},s),{},{placeholder:ve.formatMessage({id:"pages.searchTable.exception",defaultMessage:"Please enter the reason for the exception!"})})):v(i)}},{title:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.titleOption",defaultMessage:"Operating"}),dataIndex:"option",valueType:"option",render:function(i,r){return[(0,e.jsx)("a",{onClick:function(){_(!0),$(r)},children:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.edit",defaultMessage:"Edit"})},"config")]}}];return(0,e.jsxs)(Se._z,{children:[(0,e.jsx)(Me.Z,{headerTitle:ve.formatMessage({id:"pages.searchTable.title",defaultMessage:"Enquiry form"}),actionRef:w,rowKey:"activity_id",search:{labelWidth:120},toolBarRender:function(){return[(0,e.jsxs)(ie.ZP,{type:"primary",onClick:function(){g(!0)},children:[(0,e.jsx)(Pe.Z,{})," ",(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:Je,columns:me,rowSelection:{onChange:function(i,r){pe(r)}}}),(E==null?void 0:E.length)>0&&(0,e.jsx)(Ce.S,{extra:(0,e.jsxs)("div",{children:[(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,e.jsx)("a",{style:{fontWeight:600},children:E.length})," ",(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"})]}),children:(0,e.jsx)(ie.ZP,{onClick:y()(u()().mark(function c(){var i,r;return u()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,Ye(E);case 2:pe([]),(i=w.current)===null||i===void 0||(r=i.reloadAndRest)===null||r===void 0||r.call(i);case 4:case"end":return v.stop()}},c)})),children:(0,e.jsx)(o.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,e.jsxs)(be.Y,{title:"\u65B0\u5EFA\u6D3B\u52A8",width:"400px",open:h,onOpenChange:g,onFinish:function(){var c=y()(u()().mark(function i(r){var d;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Ge(r);case 2:d=s.sent,d&&(g(!1),w.current&&w.current.reload());case 4:case"end":return s.stop()}},i)}));return function(i){return c.apply(this,arguments)}}(),children:[(0,e.jsx)(K.Z,{rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u540D\u79F0"}],width:"md",name:"activity_name",label:"\u6D3B\u52A8\u540D\u79F0"}),(0,e.jsx)(ne,{width:"md",name:"introduction",label:"\u6D3B\u52A8\u63CF\u8FF0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01",min:5}]}),(0,e.jsx)(K.Z,{width:"md",name:"location",label:"\u6D3B\u52A8\u5730\u5740",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6D3B\u52A8\u5730\u5740"}]}),(0,e.jsx)(z,{name:"start_at",width:"md",label:"\u5F00\u59CB\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5F00\u59CB\u65F6\u95F4\uFF01"}]}),(0,e.jsx)(z,{name:"end_at",width:"md",label:"\u7ED3\u675F\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7ED3\u675F\u65F6\u95F4\uFF01"}]}),(0,e.jsx)(se,{name:"max_apply",width:"md",min:1,label:"\u6700\u5927\u62A5\u540D\u4EBA\u6570",fieldProps:{precision:0},rules:[{required:!0,message:"\u6700\u5927\u62A5\u540D\u4EBA\u6570!"}]})]}),(0,e.jsx)(Ie,{onSubmit:function(){var c=y()(u()().mark(function i(r){var d;return u()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,He(r);case 2:d=s.sent,d&&(_(!1),$(void 0),w.current&&w.current.reload());case 4:case"end":return s.stop()}},i)}));return function(i){return c.apply(this,arguments)}}(),onCancel:function(){_(!1),le||$(void 0)},updateModalOpen:q,values:P||{}}),(0,e.jsx)(Re.Z,{width:600,open:le,onClose:function(){$(void 0),de(!1)},closable:!1,children:(P==null?void 0:P.activity_name)&&(0,e.jsx)(De.vY,{column:2,title:P==null?void 0:P.activity_name,request:y()(u()().mark(function c(){return u()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",{data:P||{}});case 1:case"end":return r.stop()}},c)})),params:{id:P==null?void 0:P.activity_name},columns:me})})]})},Ue=Ve}}]);
